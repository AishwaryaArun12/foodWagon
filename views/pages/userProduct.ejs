<!DOCTYPE html>
<!--
	Resto by GetTemplates.co
	URL: https://gettemplates.co
-->
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <meta name="description" content="FoodWagon">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- External CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.1/css/brands.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <!-- Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700|Josefin+Sans:300,400,700">
    <link rel="stylesheet" href="https://cdn.linearicons.com/free/1.0.0/icon-font.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"> 
    <link rel="stylesheet" href="../../css/style.min.css">
    <link rel="stylesheet" href="../../css/style.min2.css">
    
</head>
<body data-spy="scroll" data-target="#navbar" class="static-layout">
	<div id="canvas-overlay"></div>
	<div class="boxed-page">
		<nav class="navbar navbar-expand-lg navbar-light bg-warning" style="z-index: 1;">
            <div class="container">
                <a class="navbar-brand d-flex" href="#">
                    <img src="https://foodwagon.co.zw/wp-content/uploads/2022/06/Icon-Form.png" alt="" width="80" height="44" class="d-inline-block align-text-top mb-4">
                    <h2><b>food<span class="text-danger">W</span>agon</b></h2>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse " id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="about.html">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/menu">Menu</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users/wishlist">Wishlist</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users/wallet">Wallet</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users/orders">Orders</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users/cart">
                                <i class="fa fa-shopping-cart" aria-hidden="true"></i> Cart
                            </a>
                        </li>
                        <% if (!login) { %>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users">Login</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users/signUp">Sign Up</a>
                        </li>
                        <% } else { %>
                        <li class="nav-item">
                            <a class="nav-link" id="nav" href="/users/profile">
                                <i class="fa fa-user-circle" aria-hidden="true"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-danger" href="/logout">Logout</a>
                        </li>
                        <% } %>
                    </ul>
                </div>
            </div>
        </nav>		
	<!-- Menu Section -->

  <!-- Page content -->
  <div class="col-lg-12 pt-3">
  <a href="/menu"><h4>More Products</h4></a>  
  
</div>
 <div class="d-flex">
    <div class="container">
        <div>
            <div class="col-lg-7 border p-1 main-section bg-white">
                <div class="row hedding m-0 pl-3 pt-0 pb-3">
                    <%=products.name%>
                </div>
                <div class="row m-0">
                    <div class="col-lg-4 left-side-product-box pb-3">
                        <div class="img-zoom-container">
            
                                <img id="main" src="/<%=products.images[0]%>" class="border p-1" onmouseenter="imageZoom('main', 'myresult')" height="230px">
            
            
                          </div>
            
                        <span class="sub-img">
                            <%for(let i = 1;i< products.images.length;i++){%>
                                <img src="/<%=products.images[i]%>" id="image<%=i%>" onclick="image('image<%=i%>')" class="border p-1">
                                <%}%>
                            
                            
                        </span>
                    </div>
                    <div id="myresult" style="display: inline-block;" class="img-zoom-result"></div>
                    <div class="col-lg-8" id="content">
                        <div class="right-side-pro-detail border p-3 m-0">
                            <div class="row">
                                <div class="col-lg-12">
                                    <span><%=products.foodType%></span>
                                    <p class="m-0 p-0"><%=products.name%></p>
                                </div>
                                <div class="col-lg-12">
                                    <p class="m-0 p-0 price-pro">&#8377;<%=products.price%></p>
                                    <hr class="p-0 m-0">
                                </div>
                                <div class="col-lg-12 pt-2">
                                    <h5>Product Detail</h5>
                                    <span><%= products.description %></span>
                                    <hr class="m-0 pt-2 mt-2">
                                </div>
                                <div class="col-lg-12">
                                    <p class="tag-section"><strong>Tag : </strong><a href=""><%= products.category %></a></p>
                                </div>
                                <div class="col-lg-12">
                                    <div class="d-flex justify-content-center justify-content-between">
                                        <h6>Quantity :</h6>
                                    <button class="btn" onclick="changeQ('plus')"><i class="fa fa-plus" aria-hidden="true"></i></button><input type="number" id="q" class="form-control text-center w-50" readonly value="1">
                                    <button class="btn" onclick="changeQ('minus')"><i class="fa fa-minus" aria-hidden="true"></i></button></i>
                                    </div>
                                </div>
                                <div class="col-lg-12 mt-3">
                                    <div class="row">
                                        <div class="col-lg-6 pb-2">
                                            <button onclick="addCart('<%=products._id%>')" id="cartBtn" class="btn btn-danger w-100">Add To Cart</button>
                                        </div>
                                        <div class="col-lg-6">
                                            <!-- <a href="/users/addcart/<%=products._id%>" onclick="alerts()" class="btn btn-success w-100">Shop Now</a> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        

    </div> 
    
    <div>
        <video id="product-video" controls autoplay muted width="450px" height="350px">
           
            <source src="/../<%=products.video%>" type="video/mp4" >
            Your browser does not support the video tag.
        </video>
    </div>
</div> 

<%if(products.rating.length!=0){%>
    <div style="margin-top: 200px;" class="ms-4">
        <h5><b>Customer rating and reviews</b></h5>
    </div>
    
   <div id="carouselExampleControls" class="carousel slide w-50 mb-5" data-bs-ride="carousel" >
    <div class="carousel-inner">
        <%products.rating.forEach((i,index)=>{%>
            <div class=<%if(index === 0){%>"carousel-item active"<%}else{%>"carousel-item"<%}%> data-bs-interval="3000">
                <p class="lead font-italic mx-4 mx-md-5 text-center">
                    <%=i.review%>
                  </p>
                  <p class="text-center">
                    <%for(let j=0;j<i.rate;j++){%>
                        <span><i class="fa fa-star text-warning " aria-hidden="true"></i></span>
                        <%}%>
                        <%for(let j=i.rate;j<5;j++){%>
                            
                            <span><i class="fa fa-star  text-secondary" aria-hidden="true"></i></span>
                            <%}%>
                  </p>
                  <div class="mt-3 mb-4 text-center">
                    <img src="<%=i.customer.image%>"
                      class="rounded-circle img-fluid shadow-1-strong" alt="smaple image" width="60"
                      height="40" />
                  </div>
                  <p class="text-muted mb-0 text-center">- <%=i.customer.name%></p>
              </div> 
       <% })%>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
  </div>
  <%}%>
  
<script>
    //  const carousel = new mdb.Carousel(document.getElementById('carouselBasicExample'), {
    //   interval: 3000, // Set the interval (in milliseconds) for auto-sliding
    // });
    function alerts(){
        window.location.href = '/users/cart'
    }
     async function addCart(id){
        let updatedQ = document.getElementById('q').value;
    await fetch(`/users/addcart/${id}/?q=${updatedQ}`).then(res=>res.json()).then(data=>{ 
        if(data.data=='Product added to cart successfully'){
            Swal.fire({    
            icon: 'success',
            title: 'Product added to cart successfully',    
            timer: 2000,
            })
        }else if(data.data == 'Already added this product to cart.'){
            Swal.fire({    
            icon: 'warning',
            title: 'Already added this product to cart.',    
            timer: 2000,
            })
        }else if(data.error){
            Swal.fire({
              icon: 'info',
              title: 'Sorry',
              text: 'Out of stock',
            })
        }
    })
  }     
  const q = document.getElementById('q');
  function changeQ(p){
    if(p == 'plus'){
        q.value = parseInt(q.value)+1;
    }else{
        if(q.value>1){
            q.value -=1;
        }
    }
  }
  const img = document.getElementById('main');
  const result = document.getElementById('myresult');
  function image(id) {
    const div = document.getElementById(id);
    let temp = div.src;
    div.src = img.src;
    img.src = temp;
    imageZoom()
  }
 
  function showMyResult() {
      result.style.display = "inline-block";
      result.style.backgroundPosition ="center";
      lens.style.display = 'block';
    }
    function hideMyResult() {
      result.style.display = "none";
      lens.style.display = "none"
    }
    var  lens, cx, cy;

/* Create lens: */
lens = document.createElement("DIV");
lens.setAttribute("class", "img-zoom-lens");
/* Insert lens: */
img.parentElement.insertBefore(lens, img);
/* Calculate the ratio between result DIV and lens: */
cx = result.offsetWidth / lens.offsetWidth;
cy = result.offsetHeight / lens.offsetHeight;
lens.addEventListener("mousemove", moveLens);
    img.addEventListener("mousemove", moveLens);
    /* And also for touch screens: */
    lens.addEventListener("touchmove", moveLens, { passive: true });
    img.addEventListener("touchmove", moveLens, { passive: true });

    function moveLens(e) {
      var pos, x, y;
      /* Prevent any other actions that may occur when moving over the image */
      e.preventDefault();
      /* Get the cursor's x and y positions: */
      pos = getCursorPos(e);
      /* Calculate the position of the lens: */
      x = pos.x - (lens.offsetWidth / 1);
      y = pos.y - (lens.offsetHeight / 1);
      /* Prevent the lens from being positioned outside the image: */
      if (x > img.width - lens.offsetWidth) {
        x = img.width - lens.offsetWidth;
      }
      if (x < 0) {
        x = 0;
      }
      if (y > img.height - lens.offsetHeight) {
        y = img.height - lens.offsetHeight;
      }
      if (y < 0) {
        y = 0;
      }
      /* Set the position of the lens: */
      lens.style.left = x + "px";
      lens.style.top = y + "px";
      /* Display what the lens "sees": */
      result.style.backgroundPosition = "-" + (x * cx) + "px -" + (y * cy) + "px";
    }
  function imageZoom() {
   
    /* Set background properties for the result DIV */
    result.style.backgroundImage = "url('" + img.src + "')";
    result.style.backgroundSize = (img.width * cx) + "px " + (img.height * cy) + "px";
    /* Execute a function when someone moves the cursor over the image, or the lens: */
    
    }
    imageZoom()
    function getCursorPos(e) {
      var a, x = 0, y = 0;
      e = e || window.event;
      /* Get the x and y positions of the image: */
      a = img.getBoundingClientRect();
      /* Calculate the cursor's x and y coordinates, relative to the image: */
      x = e.pageX - a.left;
      y = e.pageY - a.top;
      /* Consider any page scrolling: */
      x = x - window.pageXOffset;
      y = y - window.pageYOffset;
      return { x: x, y: y };
    }

    lens.addEventListener("mousemove", moveLens);
    img.addEventListener("mousemove", moveLens);

    /* Add these event listeners to show and hide myresult */
    img.addEventListener("mouseenter", showMyResult);
    img.addEventListener("mouseleave", hideMyResult);
    lens.addEventListener("mouseenter", showMyResult);
    lens.addEventListener("mouseleave", hideMyResult);
  
hideMyResult();
  
</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>



	<!-- External JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	
	
		<!-- Main JS -->
 
	
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
</body>
</html>
