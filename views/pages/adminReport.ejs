<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>Sales Report</h1>
    </div>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>#</th>
                <th>Date</th>
                <th>Product</th>
                <th>Quantity</th>
                <th>Amount</th>
                <th>Payment Method</th>
                <th>Tottal Amount</th>
                <th>Tottal Profit</th>
                <th>FoodWagon Payment</th>
                <th>Net Profit</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <%let revenue = 0; let totalProfit = 0; let netProfit = 0;%>
            <% for (let i = 0; i < orderData.length; i++) { %>
                <tr>
                    <td><%= i + 1 %></td>
                    <td><%= orderData[i].ordered_on.toLocaleDateString() %></td>
                    <td><% orderData[i].items.forEach(i=>{%>
                        <p><%=i.itemId.name%></p>
                        <%}) %></td>
                        <td><% orderData[i].items.forEach(i=>{%>
                            <p><%=i.qty%></p>
                            <%}) %></td>
                            <td><% orderData[i].items.forEach(i=>{%>
                                <p>&#8377;<%=i.amount.toFixed(2)%></p>
                                <%}) %></td>
                    <td><%= orderData[i].payment_mode %></td>
                    <td>&#8377;<%= orderData[i].amount.toFixed(2)%></td>
                    
                    <%let profit = orderData[i].amount*20/100; revenue +=orderData[i].amount %>
                    <td>&#8377;<%= profit.toFixed(2) %></td>
                    <td>&#8377;<%= profit*5/100%></td>
                    <%let net = profit - (profit*5/100); totalProfit += profit; netProfit +=net;%>
                    <td>&#8377;<%= net.toFixed(2) %></td>
                </tr>
            <% } %>
        </tbody>
    </table>
    <div class="total">
        <p>Total Sales: <%= orderData.length %></p>
        <p>Total Revenue: &#8377;<%= revenue.toFixed(2) %></p>
        <p>Total Profit: &#8377;<%= totalProfit.toFixed(2) %></p>
        <p>Total Net Profit: &#8377;<%= netProfit.toFixed(2) %></p>
    </div>
</div>
<%- include('../partials/footer') %>